# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–±–æ—Ç–∞—é—â–µ–º –±–æ—Ç–µ.

---

## üéØ –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è?

–ú–∏–≥—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—ã:
- –î–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—ã
- –°–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- –ò–∑–º–µ–Ω–∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–∑–Ω–∞–∫–∏ —Ç–æ–≥–æ, —á—Ç–æ –Ω—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è:**
- –ë–æ—Ç –≤—ã–¥–∞—ë—Ç –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –æ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—è—Ö
- –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/stats`, `/streak`)
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã SQL –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞ "no such column"

---

## ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–∏–∫–æ–≤ (—Ç–µ–∫—É—â–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)

### –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è:

**–ù–æ–≤—ã–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users`:**
- `current_streak` ‚Äî —Ç–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥
- `best_streak` ‚Äî –ª—É—á—à–∞—è —Å–µ—Ä–∏—è (—Ä–µ–∫–æ—Ä–¥)
- `last_completed_date` ‚Äî –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è

**–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**
- `badges` ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–µ–π–¥–∂–µ–π
- `user_badges` ‚Äî –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–µ–π–¥–∂–∏

**–ë–µ–π–¥–∂–∏:**
- üî• –ù–æ–≤–∏—á–æ–∫ ‚Äî 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥
- üåü –≠–Ω—Ç—É–∑–∏–∞—Å—Ç ‚Äî 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥
- üíé –ú–∞—Å—Ç–µ—Ä ‚Äî 30 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥
- üëë –õ–µ–≥–µ–Ω–¥–∞ ‚Äî 100 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥

---

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)

### –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞

```bash
# –ï—Å–ª–∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ npm
# –ù–∞–∂–º–∏—Ç–µ Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å –±–æ—Ç–æ–º

# –ï—Å–ª–∏ —á–µ—Ä–µ–∑ Docker
docker compose down
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
node scripts/migrate-streaks.js
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[–ú–ò–ì–†–ê–¶–ò–Ø] –ù–∞—á–∞–ª–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã —Å—Ç—Ä–∏–∫–æ–≤...
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –ü–æ–ª–µ current_streak –¥–æ–±–∞–≤–ª–µ–Ω–æ
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –ü–æ–ª–µ best_streak –¥–æ–±–∞–≤–ª–µ–Ω–æ
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –ü–æ–ª–µ last_completed_date –¥–æ–±–∞–≤–ª–µ–Ω–æ
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –¢–∞–±–ª–∏—Ü–∞ badges –≥–æ—Ç–æ–≤–∞
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –¢–∞–±–ª–∏—Ü–∞ user_badges –≥–æ—Ç–æ–≤–∞
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –ë–µ–π–¥–∂–µ–π –≤ –±–∞–∑–µ: 4
[–ú–ò–ì–†–ê–¶–ò–Ø] ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
# –ß–µ—Ä–µ–∑ npm
npm start

# –ß–µ—Ä–µ–∑ Docker
docker compose up -d
```

---

## üåê –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

### –ú–µ—Ç–æ–¥ 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo
git pull origin main
docker compose down
docker compose up -d
docker compose logs -f
```

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—è—Ö:
```
[–ë–î] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ current_streak –≤ —Ç–∞–±–ª–∏—Ü—É users
[–ë–î] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ best_streak –≤ —Ç–∞–±–ª–∏—Ü—É users
[–ë–î] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ last_completed_date –≤ —Ç–∞–±–ª–∏—Ü—É users
```

### –ú–µ—Ç–æ–¥ 2: –†—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞:

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ exec

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo
docker compose exec creativity-bot node scripts/migrate-streaks.js
docker compose restart
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo
docker compose exec -it creativity-bot sh
cd /app
node scripts/migrate-streaks.js
exit
docker compose restart
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
docker compose logs --tail=50
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ SQL –∏ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram:
- `/start` ‚Äî –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω–æ
- `/stats` ‚Äî –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–µ—Ä–∏–∏
- `/streak` ‚Äî –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–µ–π–¥–∂–∏

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å:

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
sqlite3 database.db "PRAGMA table_info(users);"
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo
docker compose exec creativity-bot sqlite3 /app/database.db "PRAGMA table_info(users);"
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–ª—è: `current_streak`, `best_streak`, `last_completed_date`

---

## üõü –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã:

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
# –ï—Å–ª–∏ –µ—Å—Ç—å backup
cp database.backup.db database.db
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
docker compose down

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –±—ç–∫–∞–ø–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
./scripts/restore-db.sh backup-2024-12-16.db

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
docker compose up -d
```

---

## üìù –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π

**–í–∞–∂–Ω–æ:** –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π!

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
cp database.db database.backup-$(date +%Y%m%d-%H%M%S).db
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh ubuntu@–í–ê–®_IP_–ê–î–†–ï–°
cd ~/creativity-bot-repo
./scripts/backup-db.sh
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "no such table: badges"

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é:
```bash
docker compose exec creativity-bot node scripts/migrate-streaks.js
docker compose restart
```

### –ü—Ä–æ–±–ª–µ–º–∞: "no such column: current_streak"

**–†–µ—à–µ–Ω–∏–µ:** –¢–∞ –∂–µ ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é.

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–µ–π–¥–∂–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
2. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–µ—Ä–∏—è –º–µ–Ω—å—à–µ 3 –¥–Ω–µ–π ‚Äî –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
docker compose logs | grep "–ø–æ–ª—É—á–∏–ª –±–µ–π–¥–∂"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–∏—è –≤—Å–µ–≥–¥–∞ 0

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª–µ `last_completed_date` –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—á–Ω—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–µ—Ä–∏–∏ —Å –Ω–æ–≤—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π.

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç:
- –í–∏–¥–µ—Ç—å —Å–≤–æ—é —Ç–µ–∫—É—â—É—é —Å–µ—Ä–∏—é –≤ `/stats`
- –ü–æ–ª—É—á–∞—Ç—å –±–µ–π–¥–∂–∏ –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–π —Ä–µ–∫–æ—Ä–¥ —Å–µ—Ä–∏–∏
- –í–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –≤ `/streak`

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [HOW_TO_UPDATE.md](./HOW_TO_UPDATE.md) ‚Äî –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é
- [scripts/README.md](./scripts/README.md) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- [DEPLOY.md](./DEPLOY.md) ‚Äî –¥–µ–ø–ª–æ–π –≤ –æ–±–ª–∞–∫–æ

